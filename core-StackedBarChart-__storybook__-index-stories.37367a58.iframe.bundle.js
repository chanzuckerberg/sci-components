"use strict";(self.webpackChunk_czi_sds_monorepo=self.webpackChunk_czi_sds_monorepo||[]).push([[9783],{"./packages/data-viz/src/core/StackedBarChart/__storybook__/index.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{CumulativeWithSelectionDimBehavior:()=>CumulativeWithSelectionDimBehavior,CumulativeWithSelectionHideBehavior:()=>CumulativeWithSelectionHideBehavior,Default:()=>Default,ProportionalWithSelectionDimBehavior:()=>ProportionalWithSelectionDimBehavior,ProportionalWithSelectionHideBehavior:()=>ProportionalWithSelectionHideBehavior,Test:()=>Test,WithMouseEvents:()=>WithMouseEvents,__namedExportsOrder:()=>__namedExportsOrder,default:()=>index_stories});var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/react/index.js"),src=__webpack_require__("./packages/components/src/index.ts"),emotion_styled_browser_esm=__webpack_require__("./node_modules/@emotion/styled/dist/emotion-styled.browser.esm.js");const ChartWrapper=(0,emotion_styled_browser_esm.A)("div",{target:"e1f3lqwd0"})("display:flex;flex-direction:column;width:",(props=>"number"==typeof props.width?`${props.width}px`:props.width),";"),TitleContainer=(0,emotion_styled_browser_esm.A)("div",{target:"e1f3lqwd1"})("display:flex;align-items:center;",(props=>{const spaces=(0,src.oZL)(props);return`\n      gap: ${spaces?.s}px;\n      margin-bottom: ${spaces?.l}px;\n    `})),ChartTitle=(0,emotion_styled_browser_esm.A)("div",{target:"e1f3lqwd2"})(src._Z4," ",(props=>{const semanticColors=(0,src.BdY)(props);return`\n      color: ${semanticColors?.base?.textPrimary};\n    `})),StyledBadge=(0,emotion_styled_browser_esm.A)("div",{target:"e1f3lqwd3"})(src.jP8," ",(props=>{const spaces=(0,src.oZL)(props),corners=(0,src.VP6)(props),semanticColors=(0,src.BdY)(props);return`\n      padding: ${spaces?.xxxs}px ${spaces?.xxs}px;\n      border-radius: ${corners?.m}px;\n      background-color: ${semanticColors?.base?.backgroundTertiary};\n      color: ${semanticColors?.base?.textSecondary};\n    `})),BarContainer=(0,emotion_styled_browser_esm.A)("div",{target:"e1f3lqwd4"})((props=>{const{width,barHeight,isEmpty}=props,corners=(0,src.VP6)(props),semanticColors=(0,src.BdY)(props),finalWidth="number"==typeof width?`${width}px`:width;return`\n      display: flex;\n      border-radius: ${corners?.s}px;\n      width: ${finalWidth};\n      height: ${barHeight}px;\n      background-color: ${isEmpty?semanticColors?.base?.backgroundTertiary:"transparent"};\n      overflow: hidden;\n    `})),BarSegment=(0,emotion_styled_browser_esm.A)("div",{target:"e1f3lqwd5"})((props=>{const{color,height,percentage,opacity,disabled,isLast}=props,spaces=(0,src.oZL)(props);return`\n      background-color: ${color};\n      height: ${height}px;\n      flex-grow: ${percentage};\n      flex-basis: 0;\n      flex-shrink: 1;\n      margin-right: ${percentage>0&&!isLast?`${spaces?.xxxs||0}px`:0};\n      opacity: ${opacity};\n      transition: opacity 0.2s ease-in-out, flex-grow 0.25s ease-in-out, margin-right 0.25s ease-out;\n      cursor: ${disabled?"default":"pointer"};\n      pointer-events: ${disabled?"none":"auto"};\n    `})),StyledStackedBarChartWrapper=(0,emotion_styled_browser_esm.A)("div",{target:"e1f3lqwd6"})((props=>{const spaces=(0,src.oZL)(props);return`\n      display: flex;\n      flex-direction: column;\n      gap: ${spaces?.m}px;\n    `}));var useTheme=__webpack_require__("./node_modules/@mui/material/styles/useTheme.js");const calculateLegendValue=(item,showLegendValues,legendValueFormat,globalUnit)=>{if(!showLegendValues)return;if("percentage"===legendValueFormat)return`${Math.round(item.percentage)}%`;const effectiveUnit=item.unit||globalUnit;return effectiveUnit?`${item.value} ${effectiveUnit}`:`${item.value}`},getSegmentOpacity=(index,hoveredIndex,selectedIndicesSet,selectionBehavior)=>{const hasSelection=selectedIndicesSet.size>0;return"hide"===selectionBehavior?1:null!==hoveredIndex?hoveredIndex===index||selectedIndicesSet.has(index)?1:.2:hasSelection?selectedIndicesSet.has(index)?1:.2:1},core_StackedBarChart=props=>{const{title,badge,hideBadge=!1,data,width="100%",barHeight:barHeightProp=16,showLegend=!0,showLegendValues=!0,legendValueFormat="percentage",selectedIndices=[],onSelectionChange,onSegmentMouseEnter,onSegmentMouseLeave,onLegendItemMouseEnter,onLegendItemMouseLeave,onSegmentClick,onLegendItemClick,selectionBehavior="dim",mode="proportional",maxAmount,remainingLabel="Remaining",remainingUnit,unit,colorGeneratorOptions,...rest}=props,barHeight=Math.max(1,barHeightProp),theme=(0,useTheme.A)(),[hoveredIndex,setHoveredIndex]=(0,react.useState)(null),[animatedItems,setAnimatedItems]=(0,react.useState)([]),[autoColorMap,setAutoColorMap]=(0,react.useState)(new Map),[animatedRemainingPercentage,setAnimatedRemainingPercentage]=(0,react.useState)(0),previousProcessedRef=(0,react.useRef)([]),previousDataKeysRef=(0,react.useRef)(new Set),previousColorOptionsRef=(0,react.useRef)(null),previousRemainingPercentageRef=(0,react.useRef)(0),animateItemRemoval=(0,react.useCallback)(((previousItems,nextItems,currentRemainingPercentage,newRemainingPercentage)=>{if("undefined"==typeof window)return setAnimatedItems(nextItems),previousProcessedRef.current=nextItems,setAnimatedRemainingPercentage(newRemainingPercentage),void(previousRemainingPercentageRef.current=newRemainingPercentage);const nextItemsMap=new Map(nextItems.map((item=>[item.key,item]))),removedKeys=previousItems.filter((item=>!nextItemsMap.has(item.key))).map((item=>item.key));if(0===removedKeys.length)return;const removedKeySet=new Set(removedKeys),initialItems=previousItems.map((item=>removedKeySet.has(item.key)?{...item,isExiting:!0}:{...item,isExiting:!1}));setAnimatedItems(initialItems),previousProcessedRef.current=initialItems,setAnimatedRemainingPercentage(currentRemainingPercentage);const frameIds=[],firstFrame=requestAnimationFrame((()=>{const secondFrame=requestAnimationFrame((()=>{setAnimatedItems((prev=>{const prevKeys=new Set(prev.map((item=>item.key)));return[...prev.map((item=>removedKeySet.has(item.key)?{...item,percentage:0}:{...item,isExiting:!1})),...nextItems.filter((item=>!prevKeys.has(item.key)))]})),setAnimatedRemainingPercentage(newRemainingPercentage)}));frameIds.push(secondFrame)}));frameIds.push(firstFrame);const timeoutId=window.setTimeout((()=>{setAnimatedItems(nextItems),previousProcessedRef.current=nextItems,setAnimatedRemainingPercentage(newRemainingPercentage),previousRemainingPercentageRef.current=newRemainingPercentage}),350);return()=>{frameIds.forEach((id=>window.cancelAnimationFrame(id))),window.clearTimeout(timeoutId)}}),[]),isDarkMode=(0,react.useMemo)((()=>"dark"===(0,src.Wi4)({theme})),[theme]),generateColorMap=(0,react.useCallback)((items=>{const palette=(0,src.vtD)(items.length,{...colorGeneratorOptions||{},isDarkMode}),newColorMap=new Map;return items.forEach(((item,index)=>{newColorMap.set(item.name,palette[index]||theme?.palette?.sds?.base?.ornamentSecondary)})),newColorMap}),[colorGeneratorOptions,isDarkMode,theme]);(0,react.useEffect)((()=>{const autoItems=data.filter((item=>!item.color)),currentDataKeys=new Set(data.map((item=>item.name))),previousDataKeys=previousDataKeysRef.current,previousColorOptions=previousColorOptionsRef.current,colorOptionsChanged=!previousColorOptions||previousColorOptions.isDarkMode!==isDarkMode||previousColorOptions.options!==colorGeneratorOptions;if(previousDataKeysRef.current=currentDataKeys,previousColorOptionsRef.current={options:colorGeneratorOptions,isDarkMode},0===autoItems.length)return void(autoColorMap.size>0&&setAutoColorMap(new Map));const hasNewItems=autoItems.some((item=>!previousDataKeys.has(item.name)));if(0===autoColorMap.size||hasNewItems||colorOptionsChanged)setAutoColorMap(generateColorMap(autoItems));else{const autoKeys=new Set(autoItems.map((item=>item.name))),updatedMap=new Map(autoColorMap);let hasChanges=!1;for(const key of Array.from(updatedMap.keys()))autoKeys.has(key)||(updatedMap.delete(key),hasChanges=!0);hasChanges&&setAutoColorMap(updatedMap)}}),[data,colorGeneratorOptions,isDarkMode,theme,generateColorMap]);const displayBadge=badge??(totalItems=data.length,0===(selectedCount=selectedIndices.length)||selectedCount===totalItems?`${totalItems}`:`${selectedCount} of ${totalItems}`);var totalItems,selectedCount;const{effectiveMaxAmount,hasRemaining,remainingValue,remainingPercentage}=(0,react.useMemo)((()=>{const total=data.reduce(((sum,item)=>sum+item.value),0),maxAmountValue="cumulative"===mode&&maxAmount?maxAmount:total,hasRemainingSegment="cumulative"===mode&&total<maxAmountValue,remaining=hasRemainingSegment?maxAmountValue-total:0;return{effectiveMaxAmount:maxAmountValue,hasRemaining:hasRemainingSegment,remainingValue:remaining,remainingPercentage:hasRemainingSegment?remaining/maxAmountValue*100:0}}),[data,mode,maxAmount]),dataWithPercentages=(0,react.useMemo)((()=>data.map(((item,index)=>{const resolvedColor=item.color||autoColorMap.get(item.name)||theme?.palette?.sds?.base?.ornamentSecondary;return{...item,color:resolvedColor,percentage:effectiveMaxAmount>0?item.value/effectiveMaxAmount*100:0,key:item.name,originalIndex:index}}))),[data,effectiveMaxAmount,autoColorMap,theme]);(0,react.useEffect)((()=>{const previousProcessed=previousProcessedRef.current;if(0===previousProcessed.length)return setAnimatedItems(dataWithPercentages),previousProcessedRef.current=dataWithPercentages,setAnimatedRemainingPercentage(remainingPercentage),void(previousRemainingPercentageRef.current=remainingPercentage);const cleanup=animateItemRemoval(previousProcessed,dataWithPercentages,previousRemainingPercentageRef.current,remainingPercentage);if(cleanup)return cleanup;setAnimatedItems(dataWithPercentages),previousProcessedRef.current=dataWithPercentages,setAnimatedRemainingPercentage(remainingPercentage),previousRemainingPercentageRef.current=remainingPercentage}),[dataWithPercentages,remainingPercentage,animateItemRemoval]);const selectedIndicesSet=(0,react.useMemo)((()=>new Set(selectedIndices)),[selectedIndices]),{styledItems,updatedRemainingPercentage,updatedRemainingValue}=(0,react.useMemo)((()=>((items,selectedIndicesSet,selectionBehavior,mode,hasRemaining,effectiveMaxAmount,baseRemainingPercentage,baseRemainingValue)=>{const hasSelection=selectedIndicesSet.size>0;if("hide"!==selectionBehavior||!hasSelection)return{styledItems:items,updatedRemainingPercentage:baseRemainingPercentage,updatedRemainingValue:baseRemainingValue};const selectedTotal=items.filter((item=>selectedIndicesSet.has(item.originalIndex))).reduce(((sum,item)=>sum+item.value),0);return"cumulative"===mode?((items,selectedIndicesSet,selectedTotal,hasRemaining,effectiveMaxAmount)=>{const newRemainingValue=hasRemaining?effectiveMaxAmount-selectedTotal:0,newRemainingPercentage=hasRemaining?newRemainingValue/effectiveMaxAmount*100:0;return{styledItems:items.map((item=>{const isSelected=selectedIndicesSet.has(item.originalIndex);return{...item,percentage:isSelected?item.percentage:0}})),updatedRemainingPercentage:newRemainingPercentage,updatedRemainingValue:newRemainingValue}})(items,selectedIndicesSet,selectedTotal,hasRemaining,effectiveMaxAmount):((items,selectedIndicesSet,selectedTotal)=>0===selectedTotal?{styledItems:items.map((item=>({...item,percentage:0}))),updatedRemainingPercentage:0,updatedRemainingValue:0}:{styledItems:items.map((item=>{const newPercentage=selectedIndicesSet.has(item.originalIndex)?item.value/selectedTotal*100:0;return{...item,percentage:newPercentage}})),updatedRemainingPercentage:0,updatedRemainingValue:0})(items,selectedIndicesSet,selectedTotal)})(animatedItems,selectedIndicesSet,selectionBehavior,mode,hasRemaining,effectiveMaxAmount,animatedRemainingPercentage,remainingValue)),[animatedItems,selectedIndicesSet,selectionBehavior,mode,hasRemaining,effectiveMaxAmount,animatedRemainingPercentage,remainingValue]),isHideMode="hide"===selectionBehavior&&selectedIndices.length>0,displayRemainingPercentage=isHideMode?updatedRemainingPercentage:animatedRemainingPercentage,displayRemainingValue=isHideMode?updatedRemainingValue:remainingValue,legendItems=(0,react.useMemo)((()=>((dataWithPercentages,options)=>{const{showLegendValues,legendValueFormat,unit,hasRemaining,showLegend,remainingValue,remainingPercentage,remainingLabel,remainingUnit,theme}=options,legendItems=dataWithPercentages.map((item=>({name:item.name,value:calculateLegendValue(item,showLegendValues,legendValueFormat,unit),color:item.color,disabled:item.disabled})));if(hasRemaining&&showLegend){let remainingValueDisplay;if(showLegendValues)if("percentage"===legendValueFormat)remainingValueDisplay=`${Math.round(remainingPercentage)}%`;else{const effectiveRemainingUnit=remainingUnit||unit||"";remainingValueDisplay=effectiveRemainingUnit?`${remainingValue} ${effectiveRemainingUnit}`:`${remainingValue}`}else remainingValueDisplay=void 0;legendItems.push({name:remainingLabel,value:remainingValueDisplay,color:theme?.palette?.sds?.base?.backgroundTertiary,disabled:!0})}return legendItems})(dataWithPercentages,{showLegendValues,legendValueFormat,unit,hasRemaining,showLegend,remainingValue:displayRemainingValue,remainingPercentage:displayRemainingPercentage,remainingLabel,remainingUnit,theme})),[dataWithPercentages,showLegendValues,legendValueFormat,unit,hasRemaining,showLegend,displayRemainingValue,displayRemainingPercentage,remainingLabel,remainingUnit,theme]),handleLegendItemHover=(0,react.useCallback)(((_item,index)=>{setHoveredIndex(index),onLegendItemMouseEnter&&data[index]&&onLegendItemMouseEnter(data[index],index)}),[onLegendItemMouseEnter,data]),handleLegendItemLeave=(0,react.useCallback)(((_item,index)=>{setHoveredIndex(null),onLegendItemMouseLeave&&data[index]&&onLegendItemMouseLeave(data[index],index)}),[onLegendItemMouseLeave,data]),handleLegendItemClickInternal=(0,react.useCallback)(((_item,index)=>{onLegendItemClick&&data[index]&&onLegendItemClick(data[index],index)}),[onLegendItemClick,data]),handleSelectionChange=(0,react.useCallback)((newSelectedIndices=>{if(!onSelectionChange)return;const selectedData=data.filter(((item,itemIndex)=>newSelectedIndices.includes(itemIndex)));onSelectionChange(newSelectedIndices,selectedData)}),[onSelectionChange,data]),handleSegmentClick=(0,react.useCallback)((index=>{if(onSegmentClick&&data[index]&&onSegmentClick(data[index],index),!onSelectionChange)return;const newSelectedIndices=selectedIndicesSet.has(index)?selectedIndices.filter((i=>i!==index)):[...selectedIndices,index];handleSelectionChange(newSelectedIndices)}),[onSelectionChange,onSegmentClick,data,selectedIndices,selectedIndicesSet,handleSelectionChange]),lastVisibleIndex=(0,react.useMemo)((()=>{for(let i=styledItems.length-1;i>=0;i--)if(styledItems[i].percentage>0)return i;return-1}),[styledItems]),chartContent=(0,jsx_runtime.jsxs)(StyledStackedBarChartWrapper,{children:[(0,jsx_runtime.jsxs)(BarContainer,{width,barHeight,isEmpty:0===styledItems.length&&!hasRemaining,children:[styledItems.map(((item,index)=>((item,index,options)=>{const{barHeight,hoveredIndex,selectedIndicesSet,selectionBehavior,isLast,onMouseEnter,onMouseLeave,onClick}=options,isHidden="hide"===selectionBehavior&&0===item.percentage,barSegment=(0,jsx_runtime.jsx)(BarSegment,{color:item.color,percentage:item.percentage,height:barHeight,opacity:getSegmentOpacity(item.originalIndex,hoveredIndex,selectedIndicesSet,selectionBehavior),isLast,"data-hide":isHidden,onMouseEnter,onMouseLeave,onClick});return void 0!==item.tooltip?(0,jsx_runtime.jsx)(src.m_M,{title:null,componentSlot:(0,jsx_runtime.jsx)(src.mqF,{...item.tooltip}),placement:"top",hasInvertedStyle:!1,open:hoveredIndex===item.originalIndex&&!isHidden,disableInteractive:!0,PopperProps:{disablePortal:!1,modifiers:[{name:"offset",options:{offset:[0,0]}}]},children:barSegment},item.key):(0,react.cloneElement)(barSegment,{key:item.key})})(item,0,{barHeight,hoveredIndex,selectedIndicesSet,selectionBehavior,isLast:index===lastVisibleIndex&&!hasRemaining,onMouseEnter:()=>{item.isExiting||(setHoveredIndex(item.originalIndex),onSegmentMouseEnter&&data[item.originalIndex]&&onSegmentMouseEnter(data[item.originalIndex],item.originalIndex))},onMouseLeave:()=>{setHoveredIndex(null),onSegmentMouseLeave&&data[item.originalIndex]&&onSegmentMouseLeave(data[item.originalIndex],item.originalIndex)},onClick:()=>!item.isExiting&&handleSegmentClick(item.originalIndex)}))),hasRemaining&&(0,jsx_runtime.jsx)(BarSegment,{color:theme?.palette?.sds?.base?.backgroundTertiary,percentage:displayRemainingPercentage,height:barHeight,isLast:!0,opacity:1,disabled:!0},"remaining")]}),showLegend&&(0,jsx_runtime.jsx)(src.s$2,{items:legendItems,showValues:showLegendValues,onItemMouseEnter:handleLegendItemHover,onItemMouseLeave:handleLegendItemLeave,onItemClick:onLegendItemClick?handleLegendItemClickInternal:void 0,selectedIndices,onSelectionChange:onSelectionChange?handleSelectionChange:void 0,hoveredIndex})]});return title?(0,jsx_runtime.jsxs)(ChartWrapper,{width,...rest,children:[(0,jsx_runtime.jsxs)(TitleContainer,{children:[(0,jsx_runtime.jsx)(ChartTitle,{children:title}),!hideBadge&&displayBadge&&(0,jsx_runtime.jsx)(StyledBadge,{children:displayBadge})]}),chartContent]}):(0,jsx_runtime.jsx)(ChartWrapper,{width,...rest,children:chartContent})},STACKED_BAR_CHART_DATA=[{name:"Transcriptomic",value:117,tooltip:{showSectionHeader:!0,data:[{label:"Transcriptomic",dataRows:[{label:"Sub-modality",value:14},{label:"Another sub-modality",value:19},{label:"Modality sub-type here",value:270},{label:"Sub-type of modality",value:93}]}]}},{name:"Imaging",value:61,tooltip:{data:[{label:"Imaging",dataRows:[{label:"Fluorescence microscopy",value:22},{label:"Confocal imaging",value:15},{label:"Electron microscopy",value:11},{label:"Light sheet imaging",value:8},{label:"Two-photon microscopy",value:5}]}]}},{name:"Sequencing",value:34,tooltip:{data:[{label:"Sequencing",dataRows:[{label:"RNA-seq",value:15},{label:"DNA-seq",value:10},{label:"ChIP-seq",value:6},{label:"ATAC-seq",value:3}]}]}},{name:"Proteomics",value:15,tooltip:{data:[{label:"Proteomics",dataRows:[{label:"Proteomics",value:8},{label:"Metabolomics",value:4},{label:"Flow cytometry",value:3}]}]}},{name:"Spatial Transcriptomics",value:78,tooltip:{data:[{label:"Spatial Transcriptomics",dataRows:[{label:"Spatial transcriptomics",value:60},{label:"Spatial proteomics",value:10},{label:"Spatial metabolomics",value:5},{label:"Spatial lipidomics",value:3}]}]}},{name:"Prosthetics",value:130},{name:"Epigenomics",value:100,tooltip:{data:[{label:"Epigenomics",dataRows:[{label:"DNA methylation",value:30},{label:"Histone modification",value:20},{label:"Chromatin accessibility",value:10},{label:"Chromatin remodeling",value:10},{label:"Chromatin transcription",value:10},{label:"Chromatin replication",value:30}]}]}}],default_StackedBarChart=props=>{const{data=STACKED_BAR_CHART_DATA,width=360,barHeight=16,...rest}=props;return(0,jsx_runtime.jsx)("div",{style:{margin:150},children:(0,jsx_runtime.jsx)(core_StackedBarChart,{width,data,barHeight,...rest})})};function WithSelectionStory(args){const{data,...rest}=args,[selectedIndices,setSelectedIndices]=(0,react.useState)([]),handleSelectionChange=(newIndices,selectedData)=>{setSelectedIndices(newIndices),console.log("Selected indices:",newIndices),console.log("Selected data:",selectedData)};return(0,jsx_runtime.jsxs)("div",{style:{margin:150},children:[(0,jsx_runtime.jsx)(core_StackedBarChart,{...rest,data,selectedIndices,onSelectionChange:handleSelectionChange}),(0,jsx_runtime.jsxs)("div",{style:{marginTop:"40px"},children:[(0,jsx_runtime.jsxs)("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[(0,jsx_runtime.jsx)(src.$nd,{onClick:()=>{const allIndices=data.map(((_,index)=>index));handleSelectionChange(allIndices,data)},sdsStyle:"square",sdsType:"secondary",children:"Select All"}),(0,jsx_runtime.jsx)(src.$nd,{onClick:()=>{handleSelectionChange([],[])},sdsStyle:"minimal",sdsType:"secondary",disabled:0===selectedIndices.length,children:"Clear Selection"})]}),(0,jsx_runtime.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"4px"},children:selectedIndices.length>0&&selectedIndices.map((i=>(0,jsx_runtime.jsx)(src.$JK,{label:data[i]?.name||"",onDelete:()=>(indexToRemove=>{const newIndices=selectedIndices.filter((i=>i!==indexToRemove)),newData=data.filter(((_,index)=>newIndices.includes(index)));handleSelectionChange(newIndices,newData)})(i)},i)))})]})]})}const index_stories={argTypes:{badge:{control:{type:"text"},description:"Badge text to display next to the title. If not provided, shows dynamic count based on selection"},hideBadge:{control:{type:"boolean"},description:"Hide the badge when true"},barHeight:{control:{type:"number"},description:"Height of the bar in pixels"},data:{control:{type:"object"},description:"Array of data items with name, value, and color properties"},maxAmount:{control:{type:"number"},description:"Maximum amount for the bar (used only in 'cumulative' mode). If not provided, defaults to sum of all values"},mode:{control:{type:"select"},description:"Chart mode: 'proportional' (segments fill entire bar) or 'cumulative' (segments sized based on maxAmount)",options:["proportional","cumulative"]},legendValueFormat:{control:{type:"select"},description:"Format for legend values: 'percentage' shows percentage of the item in the bar chart (e.g., '20%'), 'count' shows the count from the data object with the unit defined by the unit prop",options:["percentage","count"]},selectionBehavior:{control:{type:"select"},description:"Behavior to apply when items are selected: 'dim' makes non-selected segments semi-transparent (20% opacity), 'hide' removes non-selected segments from the bar chart",options:["dim","hide"]},remainingLabel:{control:{type:"text"},description:"Label for the remaining/unknown segment in cumulative mode"},remainingUnit:{control:{type:"text"},description:"Unit to display with the remaining segment value. If not provided, uses the unit from the first data item"},showLegend:{control:{type:"boolean"},description:"Show/hide the legend at the bottom"},showLegendValues:{control:{type:"boolean"},description:"Show percentage values in the custom legend"},title:{control:{type:"text"},description:"Title to display above the chart"},unit:{control:{type:"text"},description:"Global unit to display with values in cumulative mode. Individual data items can override this with their own unit property"},width:{control:{type:"text"},description:"Width of the chart - accepts any CSS width value (e.g., '100%', '20vw', '300px', or number for pixels)"},colorGeneratorOptions:{control:{type:"object"},description:"Options for the color generator"}},component:default_StackedBarChart,tags:["beta"],parameters:{controls:{expanded:!0}},title:"Data Viz/StackedBarChart"},DEFAULT_COLOR_GENERATOR_OPTIONS={start:240,lightness:[.4,.7],correctLightness:!0,rotations:.85,gamma:1},Default={args:{data:STACKED_BAR_CHART_DATA,title:"Domain",width:"360px",colorGeneratorOptions:{...DEFAULT_COLOR_GENERATOR_OPTIONS}}},ProportionalWithSelectionDimBehavior={render:WithSelectionStory,args:{barHeight:16,data:STACKED_BAR_CHART_DATA,mode:"proportional",showLegend:!0,showLegendValues:!0,title:"Domain",width:"360px",colorGeneratorOptions:{...DEFAULT_COLOR_GENERATOR_OPTIONS}}},CumulativeWithSelectionDimBehavior={render:WithSelectionStory,args:{barHeight:16,data:STACKED_BAR_CHART_DATA,mode:"cumulative",unit:"datasets",showLegend:!0,showLegendValues:!0,title:"Domain",width:"360px",maxAmount:700,legendValueFormat:"count",colorGeneratorOptions:{...DEFAULT_COLOR_GENERATOR_OPTIONS}}},ProportionalWithSelectionHideBehavior={render:WithSelectionStory,args:{barHeight:16,data:STACKED_BAR_CHART_DATA,mode:"proportional",showLegend:!0,showLegendValues:!0,selectionBehavior:"hide",title:"Domain",width:"360px",colorGeneratorOptions:{...DEFAULT_COLOR_GENERATOR_OPTIONS}}},CumulativeWithSelectionHideBehavior={render:WithSelectionStory,args:{barHeight:16,data:STACKED_BAR_CHART_DATA,mode:"cumulative",unit:"datasets",showLegend:!0,showLegendValues:!0,title:"Domain",width:"360px",maxAmount:700,legendValueFormat:"count",selectionBehavior:"hide",colorGeneratorOptions:{...DEFAULT_COLOR_GENERATOR_OPTIONS}}},WithMouseEvents={render:function WithMouseEventsStory(args){const{data,...rest}=args,[hoveredSegment,setHoveredSegment]=(0,react.useState)(null),[eventLog,setEventLog]=(0,react.useState)([]),theme=(0,useTheme.A)(),addToLog=message=>{setEventLog((prev=>[message,...prev].slice(0,10)))};return(0,jsx_runtime.jsxs)("div",{style:{margin:150},children:[(0,jsx_runtime.jsx)(core_StackedBarChart,{...rest,data,onSegmentMouseEnter:(item,index)=>{setHoveredSegment({item,index,source:"segment"}),addToLog(`Segment Enter: ${item.name} (index ${index})`),console.log("Segment Mouse Enter:",{item,index})},onSegmentMouseLeave:(item,index)=>{setHoveredSegment(null),addToLog(`Segment Leave: ${item.name} (index ${index})`),console.log("Segment Mouse Leave:",{item,index})},onLegendItemMouseEnter:(item,index)=>{setHoveredSegment({item,index,source:"legend"}),addToLog(`Legend Enter: ${item.name} (index ${index})`),console.log("Legend Mouse Enter:",{item,index})},onLegendItemMouseLeave:(item,index)=>{setHoveredSegment(null),addToLog(`Legend Leave: ${item.name} (index ${index})`),console.log("Legend Mouse Leave:",{item,index})},onSegmentClick:(item,index)=>{addToLog(`Segment Click: ${item.name} (index ${index})`),console.log("Segment Click:",{item,index})},onLegendItemClick:(item,index)=>{addToLog(`Legend Click: ${item.name} (index ${index})`),console.log("Legend Click:",{item,index})}}),(0,jsx_runtime.jsxs)("div",{style:{marginTop:"40px",display:"flex",gap:"16px",flexGrow:1,alignItems:"flex-start"},children:[(0,jsx_runtime.jsxs)("div",{style:{padding:"16px",backgroundColor:theme?.palette?.sds?.base?.backgroundTertiary,borderRadius:"8px",marginBottom:"16px"},children:[(0,jsx_runtime.jsx)("h3",{style:{margin:"0 0 12px 0",fontSize:"14px"},children:"Current Hover State (Hover over a bar segment or legend item):"}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("strong",{children:"Name:"})," ",hoveredSegment?.item.name||"-"]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("strong",{children:"Value:"})," ",hoveredSegment?.item.value||"-"]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("strong",{children:"Index:"})," ",hoveredSegment?.index||"-"]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("strong",{children:"Source:"})," ",hoveredSegment?.source||"-"]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("strong",{children:"Custom Color:"})," ",hoveredSegment?.item.color?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("span",{style:{display:"inline-block",width:"12px",height:"12px",backgroundColor:hoveredSegment.item.color,borderRadius:"2px",margin:"0 4px 0 2px",verticalAlign:"middle"}}),(0,jsx_runtime.jsx)("span",{children:hoveredSegment.item.color})]}):(0,jsx_runtime.jsx)("span",{children:"-"})]})]})]}),(0,jsx_runtime.jsxs)("div",{style:{padding:"16px",backgroundColor:theme?.palette?.sds?.base?.backgroundTertiary,borderRadius:"8px",maxHeight:"400px",overflow:"auto"},children:[(0,jsx_runtime.jsx)("h3",{style:{margin:"0 0 12px 0",fontSize:"14px"},children:"Event Log (last 10 events):"}),0===eventLog.length?(0,jsx_runtime.jsx)("div",{style:{fontSize:"12px"},children:"No events yet. Hover or click on segments or legend items to see events."}):(0,jsx_runtime.jsx)("ul",{style:{margin:0,padding:"0 0 0 20px",fontSize:"12px",fontFamily:"monospace"},children:eventLog.map(((event,index)=>(0,jsx_runtime.jsx)("li",{style:{marginBottom:"4px"},children:event},index)))})]})]})]})},args:{barHeight:16,data:STACKED_BAR_CHART_DATA,showLegend:!0,showLegendValues:!0,title:"Mouse Events Demo",width:"360px",colorGeneratorOptions:{...DEFAULT_COLOR_GENERATOR_OPTIONS}}},Test={args:{data:STACKED_BAR_CHART_DATA,title:"Domain",width:360},parameters:{snapshot:{skip:!0}},render:props=>(0,jsx_runtime.jsx)(default_StackedBarChart,{...props,"data-testid":"stacked-bar-chart"})},__namedExportsOrder=["Default","ProportionalWithSelectionDimBehavior","CumulativeWithSelectionDimBehavior","ProportionalWithSelectionHideBehavior","CumulativeWithSelectionHideBehavior","WithMouseEvents","Test"];Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:'{\n  args: {\n    data: STACKED_BAR_CHART_DATA,\n    title: "Domain",\n    width: "360px",\n    colorGeneratorOptions: {\n      ...DEFAULT_COLOR_GENERATOR_OPTIONS\n    }\n  }\n}',...Default.parameters?.docs?.source}}},ProportionalWithSelectionDimBehavior.parameters={...ProportionalWithSelectionDimBehavior.parameters,docs:{...ProportionalWithSelectionDimBehavior.parameters?.docs,source:{originalSource:'{\n  render: WithSelectionStory,\n  args: {\n    barHeight: 16,\n    data: STACKED_BAR_CHART_DATA,\n    mode: "proportional",\n    showLegend: true,\n    showLegendValues: true,\n    title: "Domain",\n    width: "360px",\n    colorGeneratorOptions: {\n      ...DEFAULT_COLOR_GENERATOR_OPTIONS\n    }\n  }\n}',...ProportionalWithSelectionDimBehavior.parameters?.docs?.source}}},CumulativeWithSelectionDimBehavior.parameters={...CumulativeWithSelectionDimBehavior.parameters,docs:{...CumulativeWithSelectionDimBehavior.parameters?.docs,source:{originalSource:'{\n  render: WithSelectionStory,\n  args: {\n    barHeight: 16,\n    data: STACKED_BAR_CHART_DATA,\n    mode: "cumulative",\n    unit: "datasets",\n    showLegend: true,\n    showLegendValues: true,\n    title: "Domain",\n    width: "360px",\n    maxAmount: 700,\n    legendValueFormat: "count",\n    colorGeneratorOptions: {\n      ...DEFAULT_COLOR_GENERATOR_OPTIONS\n    }\n  }\n}',...CumulativeWithSelectionDimBehavior.parameters?.docs?.source}}},ProportionalWithSelectionHideBehavior.parameters={...ProportionalWithSelectionHideBehavior.parameters,docs:{...ProportionalWithSelectionHideBehavior.parameters?.docs,source:{originalSource:'{\n  render: WithSelectionStory,\n  args: {\n    barHeight: 16,\n    data: STACKED_BAR_CHART_DATA,\n    mode: "proportional",\n    showLegend: true,\n    showLegendValues: true,\n    selectionBehavior: "hide",\n    title: "Domain",\n    width: "360px",\n    colorGeneratorOptions: {\n      ...DEFAULT_COLOR_GENERATOR_OPTIONS\n    }\n  }\n}',...ProportionalWithSelectionHideBehavior.parameters?.docs?.source}}},CumulativeWithSelectionHideBehavior.parameters={...CumulativeWithSelectionHideBehavior.parameters,docs:{...CumulativeWithSelectionHideBehavior.parameters?.docs,source:{originalSource:'{\n  render: WithSelectionStory,\n  args: {\n    barHeight: 16,\n    data: STACKED_BAR_CHART_DATA,\n    mode: "cumulative",\n    unit: "datasets",\n    showLegend: true,\n    showLegendValues: true,\n    title: "Domain",\n    width: "360px",\n    maxAmount: 700,\n    legendValueFormat: "count",\n    selectionBehavior: "hide",\n    colorGeneratorOptions: {\n      ...DEFAULT_COLOR_GENERATOR_OPTIONS\n    }\n  }\n}',...CumulativeWithSelectionHideBehavior.parameters?.docs?.source}}},WithMouseEvents.parameters={...WithMouseEvents.parameters,docs:{...WithMouseEvents.parameters?.docs,source:{originalSource:'{\n  render: WithMouseEventsStory,\n  args: {\n    barHeight: 16,\n    data: STACKED_BAR_CHART_DATA,\n    showLegend: true,\n    showLegendValues: true,\n    title: "Mouse Events Demo",\n    width: "360px",\n    colorGeneratorOptions: {\n      ...DEFAULT_COLOR_GENERATOR_OPTIONS\n    }\n  }\n}',...WithMouseEvents.parameters?.docs?.source}}},Test.parameters={...Test.parameters,docs:{...Test.parameters?.docs,source:{originalSource:'{\n  args: {\n    data: STACKED_BAR_CHART_DATA,\n    title: "Domain",\n    width: 360\n  },\n  parameters: {\n    snapshot: {\n      skip: true\n    }\n  },\n  render: (props: Parameters<typeof StackedBarChart>[0]) => <StackedBarChart {...props} data-testid="stacked-bar-chart" />\n}',...Test.parameters?.docs?.source}}}}}]);